From 1b836e7e1478d1954b291b097fe310b9c249b84c Mon Sep 17 00:00:00 2001
From: Satya Prakash Gupta <sp.gupta@samsung.com>
Date: Mon, 24 Jul 2017 13:23:17 +0530
Subject: [PATCH] ssaparse: Fix buffer leak in error case

https://bugzilla.gnome.org/show_bug.cgi?id=785331
---
 gst/subparse/gstssaparse.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/gst/subparse/gstssaparse.c b/gst/subparse/gstssaparse.c
index 9b00e79..c849c08 100644
--- a/gst/subparse/gstssaparse.c
+++ b/gst/subparse/gstssaparse.c
@@ -169,8 +169,10 @@ gst_ssa_parse_setcaps (GstPad * sinkpad, GstCaps * caps)
 
   gst_buffer_ref (priv);
 
-  if (!gst_buffer_map (priv, &map, GST_MAP_READ))
+  if (!gst_buffer_map (priv, &map, GST_MAP_READ)) {
+    gst_buffer_unref (priv);
     return FALSE;
+  }
 
   GST_MEMDUMP_OBJECT (parse, "init section", map.data, map.size);
 
-- 
2.9.5

